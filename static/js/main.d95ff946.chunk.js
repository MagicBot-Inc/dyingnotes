(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[function(t,e,n){t.exports=n(1)},function(t,e,n){"use strict";n.r(e);var o=null,r=function(t,e){for(var n=t.split(","),o=n[0].match(/:(.*?);/)[1],r=atob(n[1]),a=r.length,c=new Uint8Array(a);a--;)c[a]=r.charCodeAt(a);return new File([c],e,{type:o})};e.default={init:function(t){o=t},shareStory:function(t,e,n){var a=n.add_to_news,c=void 0!==a&&a,i=n.user_ids,s=void 0===i?[]:i;return new Promise(function(n,a){o.send("VKWebAppGetAuthToken",{app_id:t,scope:"stories"}).then(function(i){var u=i.data.access_token;o.send("VKWebAppCallAPIMethod",{method:"stories.getPhotoUploadServer",params:{access_token:u,add_to_news:c?"1":"0",user_ids:s.join(","),link_text:"open",link_url:"https://vk.com/app"+t,v:"5.95"}}).then(function(t){var o=t.data.response.upload_url,c=new FormData;c.append("file",r(e,"story.png")),fetch("https://cors-anywhere.herokuapp.com/"+o,{method:"POST",body:c}).then(function(t){return t.json()}).then(function(t){return n(t.response.story)}).catch(function(){return a({error_code:3,error_text:"Can't upload story"})})}).catch(function(){return a({error_code:2,error_text:"Can't get upload url"})})}).catch(function(){return a({error_code:1,error_text:"Can't get access_token"})})})},generateStoryFromTemplate:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return new Promise(function(n){var o=document.createElement("canvas");o.width=1080,o.height=1920;var r=o.getContext("2d"),a=new Image;a.onload=function(){r.drawImage(a,0,0),e.forEach(function(t){r.font=t.font,r.textAlign=t.align,r.fillStyle=t.color,r.fillText(t.value,t.x,t.y)}),n(o.toDataURL())},a.src=t})}}}],[[0,1]]]);
//# sourceMappingURL=main.d95ff946.chunk.js.map